# 并发知识梳理

## 进程
程序的一次执行过程，进程间相互独立。

## 线程
比线程更小的执行单位，同类线程共享**进程的堆和方法区**，但也有私有的**程序计数器**、**虚拟机栈**和**本地方法栈**，线程间切换工作的负担比进程小，又称轻量级进程。

## 程序计数器
程序计数器**用于记录当前线程执行的位置**，所以线程私有；为了**保证线程中的局部变量不被别的线程访问到**，虚拟机栈和本地方法栈是线程私有的。

## 堆和方法区
堆和方法区是线程共享的资源，堆是进程中最大的一块内存，主要用于存放新创建的对象，方法区用于存放已被加载的类信息、常量、静态变量、即时编译器编译后的代码等数据。

## 并发
多个任务交互执行；并行：多个任务同时进行。

## 使用多线程的好处
提高CPU利用率，提高系统整体的并发能力以及性能。

## 线程生命周期的6种状态
![](_v_images/20191219220400669_8836.png)

## 线程状态变迁
![](_v_images/20191219220417149_17193.png)

## 上下文切换
当前任务在执行完CPU时间片切换到另一个任务之前会保存自己的状态，以便下次再切换回这个任务时，可以再加载这个任务的状态。**任务从保存到再加载的过程**就是一次上下文切换。

## 线程死锁
两个线程都在等待对方释放占有的资源。
避免死锁的方法：

- 一次性申请所有的资源。
- 占用部分资源的线程在申请不到其他资源时，主动释放占有的资源。
- 按序申请资源。

## sleep()和wait()的区别
- sleep没有释放锁，wait释放了锁。
- wait被调用后，线程不会自动苏醒；sleep被调用后，线程会自动苏醒。